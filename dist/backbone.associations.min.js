/**
 * Backbone.Associations v0.1.0
 * https://github.com/DreamTheater/Backbone.Associations
 *
 * Copyright Â© 2012 Dmytro Nemoga
 * Released under the MIT license.
 */
(function(){"use strict";Backbone.Associations={};var e=Backbone.Associations.BelongsTo=function(e){};_.extend(e.prototype,{});var t=Backbone.Associations.HasMany=function(e){};_.extend(t.prototype,{});var n=Backbone.Associations.HasOne=function(e){};_.extend(n.prototype,{});var r=Backbone.Model;_.extend(r.prototype,{belongsTo:{},hasMany:{},hasOne:{},toJSON:_.wrap(r.prototype.toJSON,function(e,t){t=_.extend({associations:!1},t);var n=e.call(this,t);return n})}),Backbone.sync=_.wrap(Backbone.sync,function(e,t,n,r){if(t!=="read")return e.call(this,t,n,r);r=_.extend({},r);var i=$.Deferred(),s=[],o=_.bind(function(e,t,n){delete this._xhrCache,_.isFunction(e)&&e.call(this,this,t,n)},n),u=_.bind(function(e,t,n,s){i.resolve(t,n,s),_.isFunction(e)&&e.call(this,this,t,r)},n),a=_.bind(function(e,t,n,s){i.reject(t,n,s),_.isFunction(e)&&e.call(this,this,t,r)},n),f=_.bind(function(){_.isUndefined(this._xhrCache)?this._xhrCache=e.call(this,"read",n,r):this._xhrCache.then(i.resolve,i.reject)},n);return _.extend(r,{complete:_.wrap(r.complete,o),success:_.wrap(r.success,u),error:_.wrap(r.error,a)}),$.when.apply($,s).then(f),i.promise()})})();